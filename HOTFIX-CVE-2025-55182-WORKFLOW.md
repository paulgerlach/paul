# üî¥ HOTFIX: CVE-2025-55182 React2Shell RCE

> **Priority:** CRITICAL  
> **CVE:** CVE-2025-55182 (React), CVE-2025-66478 (Next.js)  
> **Attack Vector:** Remote Code Execution via React Server Components  
> **Affected:** Next.js 15.3.1 ‚Üí Patch to 15.3.6

---

## Atomic Workflow Checklist

### Phase 1: Pre-Flight ‚úàÔ∏è

```powershell
# 1.1 Verify current branch and status
git status
git branch --show-current

# 1.2 Stash any work-in-progress
git stash -m "WIP before CVE-2025-55182 hotfix"

# 1.3 Sync with remote
git fetch origin
```

**Checkpoint:** Clean working directory, no uncommitted changes

---

### Phase 2: Branch Strategy üåø

```powershell
# 2.1 Checkout main and pull latest
git checkout main
git pull origin main

# 2.2 Create hotfix branch from main
git checkout -b hotfix/cve-2025-55182-react2shell

# 2.3 Verify branch
git branch --show-current
# Expected: hotfix/cve-2025-55182-react2shell
```

**Checkpoint:** On fresh hotfix branch based on latest main

---

### Phase 3: Surgical Fix üîß

```powershell
# 3.1 Open package.json and update ONLY these two lines:
```

**File:** `package.json`

| Package | Before | After |
|---------|--------|-------|
| `next` | `"15.3.1"` | `"15.3.6"` |
| `eslint-config-next` | `"15.3.1"` | `"15.3.6"` |

```json
// Line ~48
"next": "15.3.6",

// Line ~78  
"eslint-config-next": "15.3.6",
```

```powershell
# 3.2 Install patched dependencies
pnpm install

# 3.3 Verify installation
pnpm list next
# Expected: next 15.3.6
```

**Checkpoint:** `pnpm-lock.yaml` updated, next@15.3.6 installed

---

### Phase 4: Verification üß™

```powershell
# 4.1 Build test (catches compile errors)
pnpm build

# 4.2 Dev server test
pnpm dev
```

**Manual Checks:**
- [ ] App loads at `http://localhost:3000`
- [ ] Browser console: `next.version` returns `"15.3.6"`
- [ ] No console errors
- [ ] Auth flow works (login/logout)
- [ ] One Server Action works (e.g., create/edit form)

```powershell
# 4.3 Stop dev server (Ctrl+C)
```

**Checkpoint:** App builds and runs without regression

---

### Phase 5: Commit & Push üì§

```powershell
# 5.1 Stage only the relevant files
git add package.json pnpm-lock.yaml

# 5.2 Verify staged files (should be ONLY 2 files)
git status

# 5.3 Commit with conventional commit format
git commit -m "fix(security): patch CVE-2025-55182 React2Shell RCE

BREAKING: None - patch release only

Changes:
- next: 15.3.1 ‚Üí 15.3.6
- eslint-config-next: 15.3.1 ‚Üí 15.3.6

Vulnerability: Remote Code Execution via React Server Components
Severity: Critical (CVSS 10.0)
Reference: https://github.com/vercel/next.js/security/advisories"

# 5.4 Push hotfix branch
git push origin hotfix/cve-2025-55182-react2shell
```

**Checkpoint:** Hotfix branch pushed to remote

---

### Phase 6: Create Pull Request üìã

**PR Title:**
```
üî¥ [SECURITY] Patch CVE-2025-55182 React2Shell RCE - Next.js 15.3.6
```

**PR Description:**
```markdown
## üî¥ Security Hotfix

### CVE Details
- **CVE-2025-55182** (React Server Components)
- **CVE-2025-66478** (Next.js)
- **Severity:** Critical - Remote Code Execution
- **CVSS Score:** 10.0

### Changes
| Package | Before | After |
|---------|--------|-------|
| next | 15.3.1 | 15.3.6 |
| eslint-config-next | 15.3.1 | 15.3.6 |

### Testing
- [x] `pnpm build` passes
- [x] `pnpm dev` runs without errors
- [x] Verified `next.version` = 15.3.6
- [x] Auth flow functional
- [x] Server Actions functional

### Risk Assessment
- **Breaking Changes:** None (patch release)
- **Regression Risk:** Minimal
- **Rollback:** Revert to 15.3.1 if needed

### References
- [Vercel Security Bulletin](https://vercel.com/security)
- [Next.js Security Advisories](https://github.com/vercel/next.js/security/advisories)

### Post-Merge Actions
‚ö†Ô∏è After deployment, rotate all secrets (see checklist below)
```

**PR Settings:**
- Base: `staging`
- Labels: `security`, `hotfix`, `critical`
- Reviewers: @security-team (if applicable)
- Auto-merge: Enable after approval

---

### Phase 7: Merge Path üöÄ

```
hotfix/cve-2025-55182-react2shell
         ‚Üì
      staging (test in staging environment)
         ‚Üì
       main (production deployment)
```

```powershell
# After PR approval and staging verification:
# Merge staging ‚Üí main via PR or:
git checkout main
git merge staging
git push origin main
```

---

### Phase 8: Post-Deployment üîê

**CRITICAL: Rotate Secrets**

If app was online and unpatched before Dec 4, 2025:

- [ ] Supabase API keys
- [ ] Prismic API tokens
- [ ] Any `.env` secrets
- [ ] Database credentials
- [ ] Third-party API keys

```powershell
# Verify production deployment
# Check Vercel dashboard or:
curl -s https://your-app.vercel.app | grep -o 'next.version'
```

---

## Rollback Plan üîÑ

If issues occur after deployment:

```powershell
# Option 1: Revert commit
git revert HEAD
git push origin main

# Option 2: Pin to previous version
# In package.json:
"next": "15.3.1"
pnpm install
git commit -am "revert: rollback Next.js to 15.3.1"
git push origin main
```

---

## Timeline ‚è±Ô∏è

| Phase | Duration | Cumulative |
|-------|----------|------------|
| Pre-Flight | 2 min | 2 min |
| Branch | 1 min | 3 min |
| Fix | 3 min | 6 min |
| Verify | 5 min | 11 min |
| Commit/Push | 2 min | 13 min |
| PR | 3 min | 16 min |
| Review/Merge | 5-10 min | ~25 min |

**Total ETA: 25-30 minutes** for complete surgical fix

---

## Sign-Off

| Role | Name | Date | Signature |
|------|------|------|-----------|
| Developer | | | |
| Reviewer | | | |
| CTO | | | |

---

*Generated: December 8, 2025*  
*Workflow Version: 1.0*





